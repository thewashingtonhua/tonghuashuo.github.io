{"componentChunkName":"component---src-templates-blog-post-tsx","path":"/blog/2019/12/03/learning-flutter","result":{"data":{"site":{"siteMetadata":{"title":"童话说","keywords":["tonghuashuo","github","front-end","javascript","typescript","react","node","washington","hua","童话","童话说","前端","博客","技术","计算机","互联网"]}},"markdownRemark":{"html":"<h2>起源</h2>\n<p>这篇文章，记录了我在学习 Flutter 的过程中踩过的各种雷，方便自己日后再遇到时能够有据可循，同时也分享给各位初上手 Flutter 的同行们。</p>\n<h2>雷区</h2>\n<h3>雷区1：Dart Not Found</h3>\n<p>通常，在安装完一个新的工具后，我们都会习惯性的通过 <code class=\"gatsby-code-text\">which</code> 命令检查下是否安装成功。但在安装完 Flutter 之后，<code class=\"gatsby-code-text\">which flutter</code> 返回了正确的结果，<code class=\"gatsby-code-text\">which dart</code> 却报 <code class=\"gatsby-code-text\">dart not found</code>。</p>\n<p>检查 Flutter 目录下的内容，发现在 <code class=\"gatsby-code-text\">PATH_TO_FLUTTER/bin/cache/dart-sdk/bin</code> 目录下是存在 dart 的可执行文件的，通过这个地址调用 dart 也确实可以正常使用。既然 Flutter 内置了 Dart，<code class=\"gatsby-code-text\">PATH_TO_FLUTTER/bin</code> 目录也已经添加到环境变量，为何 Flutter 可以访问但 Dart 却不行呢？</p>\n<p>查阅官方文档了解到，Flutter 内置的 Dart 仅供 Flutter 使用，并非全局安装。</p>\n<blockquote>\n<p>If you’re developing only mobile apps, then you don’t need the Dart SDK; just <a href=\"https://flutter.dev/docs/get-started/install\" target=\"_blank\" rel=\"noopener noreferrer\">install Flutter</a>.</p>\n</blockquote>\n<blockquote>\n<p>如果你只是用来开发移动应用，那么你不需要 Dart SDK，只管<a href=\"https://flutter.dev/docs/get-started/install\" target=\"_blank\" rel=\"noopener noreferrer\">安装 Flutter</a> 即可。</p>\n</blockquote>\n<p>也就是说，Flutter 的运行并不依赖全局的 Dart，所以我们遇到的情况是正常的。</p>\n<p>如果朋友们有强迫症，一定要全局安装 Dart，或是想用 Dart 做点 Flutter 以外的事情，那么有两种方式：</p>\n<ol>\n<li>把 <code class=\"gatsby-code-text\">PATH_TO_FLUTTER/bin/cache/dart-sdk/bin</code> 添加到环境变量，使用 Flutter 内置的 Dart 作为全局 Dart。</li>\n<li>\n<p>通过 Homebrew 单独安装 Dart。</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"gatsby-code-bash line-numbers\"><code class=\"gatsby-code-bash\">brew tap dart-lang/dart\nbrew <span class=\"token function\">install</span> dart</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>\n</li>\n</ol>\n<h3>雷区2：Android License Status Unknown</h3>\n<p>如果你是跟着官方文档安装的 Flutter，那么一定运行过 <code class=\"gatsby-code-text\">flutter doctor</code> 这个工具。大部分时候我们只需要缺什么补什么一个个安装即可，但有一个问题困扰了不少人，Github 和 Stackoverflow 上问的也比较多，那就是「Android License Status Unknown」。</p>\n<p>一番搜索，大部分都会提示执行一下 <code class=\"gatsby-code-text\">flutter doctor --android-licenses</code>，执行完之后，剧情开始分叉：</p>\n<p>剧情 1：很顺利，命令行提示有一些 Android 工具的 license 没有同意，需要手动同意一下。我在公司和自己的电脑上都配过，一个之前配过 Android 环境，一个没有，都出现了这个问题，所以不要慌，按照提示一路按「y」同意即可</p>\n<p>剧情 2：命令行提示 Android SDK 有新版本，需要先更新：</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"gatsby-code-bash line-numbers\"><code class=\"gatsby-code-bash\">A newer version of the Android SDK is required. To update, run:\n~/Android/sdk/tools/bin/sdkmanager --update</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>\n<p>根据提示执行：<code class=\"gatsby-code-text\">~/Android/sdk/tools/bin/sdkmanager --update</code>，这时候又出现了新的剧情分叉：</p>\n<p>剧情 2.1：更新很顺利，回到剧情 1，顺利完结。</p>\n<p>剧情 2.2：报 Java 错误，提示有些类包不存在。</p>\n<p>经过一通翻天覆地的搜索，以及亲自试错，我可以很负责任地告诉大家，确实跟 JDK 版本有关系。（奇怪的是，Google 官方并没有表示 Android 开发对 JDK 版本的要求，又或者只是藏在了更深的地方我没发现）实测验证，剧情 2.2 仅在 JDK 9 及以上的环境中能够解锁，JDK 8 并不会遇到（主流环境应该至少有 8 了吧，再早的就过分了）。据知情人士透露，JDK 9 开始移除了一些包，导致了这个问题。而我因为是新配的环境，默认下了当前最新的 JDK 13，因此遇到了这个问题。</p>\n<p>鉴于本人对 Java 并不熟，大学毕业后就没再正经碰过，不是很了解现在的发展情况，在询问了身边做 Android 开发的朋友后得知高版本也并非刚需，并且我的目标是 Flutter，Java 在这里不是重点，因此这里我选择降级到 JDK 8。如果有不甘心的朋友非新版本 JDK 不可，<a href=\"https://www.wandouip.com/t5i325108/\" target=\"_blank\" rel=\"noopener noreferrer\">这里</a>有位仁兄整理了如何补齐缺失类包的方法，我没有亲自验证过，但看样子应该是那么回事，有兴趣的可以前往一读。</p>","frontmatter":{"title":"Flutter 扫雷记","description":"目标，移动端，走起","cover":{"publicURL":"/static/flutter-b6ce1e63c11d6fddd7a988bfb312deb5.jpg"},"tags":["flutter"],"series":"","draft":true},"fields":{"id":"learning-flutter","date":"2019-12-02T16:00:00.000Z"}}},"pageContext":{"slug":"/blog/2019/12/03/learning-flutter"}}}