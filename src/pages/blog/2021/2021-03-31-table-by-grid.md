---
title: '基于 CSS Grid 的 Table 实现'
description: '换种思路解决问题'
tags: ['grid', 'table', 'css']
cover: '../../../images/blog/blank.jpg'
series: ''
draft: true
original: true
---

## 先看场景

技术是为业务服务的，脱离业务场景去谈技术的优劣就是在耍流氓。

表头固定：滚动

大数据量：虚拟滚动

## 为什么要自己做？AntD 它不香吗？

首先要承认，AntD 作为可能是目前国内 React 生态圈最成熟的组件库，其在 Table 上下的功夫不是一般个人或者小团队能够比拟的，这一点还是要 Respect 的。

既然如此，那为什么不用 AntD 呢？

其实一开始我们就是用的 AntD，作为表格的主要功能都是可以做到的，没有重复发明轮子的必要。但在定制化的过程中

首先作为一个现代化的 Table 的组件来说，光靠一个标准的 table 标签肯定是无法满足的。table 标签结构的限制，标准的 table 标签本身存在一些限制，决定了很多自定义的行为需要打破规则来做，比如很多看上去是一个 Table 的组件，内部其实是由多组 table 标签实现构成的。再比如 tr 不能有 margin，不能有背景色，不能有 before、after 等。

AntD API 的限制，AntD 的 Table 组件不支持监听 onScroll，需要自己实现 body，成本差不多了。为通用牺牲的性能，Select 的自定义

Ant Design 自带样式带来的麻烦，设计语言上的不一致，决定了需要各种样式覆盖。

自由和限制的平衡，AntD 太过通用，我们可能只用到其中一部分的功能，却要因此受到大量的限制。

所以还是文章开头提到的，业务场景决定技术方案，我们不是为了造轮子而造轮子，只是业务决定了我们需要定制一款更适合的轮子。

下面，开始造轮子。

## 剖析：Table 的结构特点

### 标准 DOM 结构

### Table vs List

List - 单列的 Table

### Table vs Grid

Grid - 有空座 Table

## 核心难点

### 列宽同步

不使用 colgroup 的前提下，如何同步各自由列的宽度 - CSS Grid

### 可选的表头

### 虚拟滚动

性能原因

### 无限加载

触底判断

### 横向滚动同步

超宽表格

## 这么做的优点

### 统一实现

统一：可以基于同一套方案，去实现 Layout、Virtual List、滚动监听

性能优化：单元格级的更新

### 兼容性

移动端？小程序？

## 缺点

### 缺乏语义化

全 Div 对屏幕阅读器不友好，纯靠 aira-role 支持

### 列宽同步

依赖业务方自己支持

## 小结
