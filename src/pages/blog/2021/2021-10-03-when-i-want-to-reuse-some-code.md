---
title: '当我想要复用一些代码时'
description: '懒惰真的是人类进步的最大动力'
tags: ['npm', 'monorepo', 'design pattern']
cover: '../../../images/blog/blank.jpg'
series: ''
draft: true
original: true
---

## 复制粘贴

这是最简单的方法，尤其当代码片段并不大的时候。

老话说事不过三，当一段代码只有 2 处引用的时候，我可能并不会想着一定要抽取公共，因为投入产出比似乎并不高，虽然理论上抽取公共会更合理，但如果不这么做，问题也不大。这种状态会一直延续下去，直到出现我第 3 次引用到它，这会让我意识到，不行，我得做点什么了。

### 提取公共

这是最初级的代码复用形式，别误会，很多时候最简单的方法也最有效，杀个鸡而已，不用请牛刀。

值得注意的是，提取公共的主要目的并不是为了减少代码量，而是为了建立 Single Source of Truth（抱歉，我不是为了拽英文，只是习惯了这种表述方式，如果一定要翻译成「唯一真相」，感觉有点生硬）。

## ESM

ESM 是 ES 标准中非常重要的一个特性，它在语言层面上支持了模块化，让代码的分隔管理有了

### 设计模式

除了代码片段逻辑可以复用，创建代码的方法论，或者说经验，也是可以复用的。设计模式就是对常见问题的解决方案的一种经验总结。无论你使用什么语言，面向什么平台编写，大部分常见问题都能找到现成的设计模式。

### npm

npm 是个好东西，不仅提供了一种模块的管理机制，同时还提供了一个在线托管平台，在其他项目中，只需要引用这个包就可以了。

### monorepo

Monorepo 可以说是时下比较流行的一种代码组织结构，可以把原本分散在不同仓库，但又经常互相依赖的代码组织到一起，既能独立管理每一个模块，又能很好的彼此协作。

说来 Monorepo 并不是一个最近才出现的东西，Google 很早就开始用，一直到现在，但是在社区里流行起来大概是在近几年，尤其是对于一些大型的项目。我觉得之所以现在开始流行，一个很重要的原因在于跨端的场景越来越多，我们可以用同一项技术开发面向不同平台的应用，于是我们需要一种更好的代码管理方式。
